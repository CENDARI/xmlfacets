{% extends 'base.html' %}

{% load highlight display %}

{% block css %}
<style type="text/css">

  .container {
      height: 1%;
  }

  .leftpanel {
      float: left;
      padding: 5px;
      width: 200px;
      border: 1px solid black;
  }
  .mainpanel {
      padding: 5px;
      margin-left: 210px;
  }
  .highlighted {
    background: #faa732;
    padding: 2px;
  }
  .searchresult > a * {
    display: inline;
  }
  .searchresult {
    margin-bottom: .75em;
  }
</style>
{% endblock %}

{% block content %}
<form method="get" action=".">
  <p>
    {{ form }}
    <input type="submit" value="Search">
  </p>

<!-- Begin faceting. -->
<div class="leftpanel">
  <h2>Facets (<a href="?q=">reset</a>)</h2>
  <hr>
  {% if facets.fields.themes %}
  <dl>
    <dt>Themes</dd>
    {% for theme in facets.fields.themes %}
    <dd><a href="{{ request.get_full_path }}&amp;selected_facets=themes_exact:{{ theme.0|urlencode }}">{{ theme.0 }}</a> ({{ theme.1 }})</dd>
    {% endfor %}
  </dl>
    {% else %}
    <p>None</p>
    {% endif %}

  {% if facets.fields.countries %}
  <dl>
    <dt>Countries</dd>
    {% for country in facets.fields.countries %}
    <dd><a href="{{ request.get_full_path }}&amp;selected_facets=countries_exact:{{ country.0|urlencode }}">{{ country.0 }}</a> ({{ country.1 }})</dd>
    {% endfor %}
  </dl>
    {% else %}
    <p>None</p>
    {% endif %}

  {% if facets.fields.firsttag %}
  <dl>
    <dt>First Tag</dd>
    {% for firsttag in facets.fields.firsttag %}
    <dd><a href="{{ request.get_full_path }}&amp;selected_facets=firsttag_exact:{{ firsttag.0|urlencode }}">{{ firsttag.0 }}</a> ({{ firsttag.1 }})</dd>
    {% endfor %}
  </dl>
    {% else %}
    <p>None</p>
    {% endif %}

    {% if facets.fields.languages %}
  <dl>
    <dt>Language</dt>
    {% for language in facets.fields.languages %}
    <dd><a href="{{ request.get_full_path }}&amp;selected_facets=languages_exact:{{ language.0|urlencode }}">{{ language.0 }}</a> ({{ language.1 }})</dd>
    {% endfor %}
  </dl>
    {% else %}
    <p>None</p>
    {% endif %}
</div>
    <!-- End faceting -->

<div class="container">
<div class="mainpanel">
  <h2>Results ({{ page.paginator.count }}) 
    {% if page.has_previous %}<a href="?q={{ query }}&amp;page=1">1</a>
<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Prev {% if page.has_previous %}</a>{% endif %} 
    | {{ page.number }} | 
    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>
    <a href="?q={{ query }}&amp;page={{ page.paginator.num_pages }}">{{ page.paginator.num_pages }}</a>{% endif %}
  </h2>
  <hr>

  <ol>
    {% for result in page.object_list %}
    <li>
      <a href="{{ result.object.get_absolute_url }}">{{ result.object.filename }}</a>
      <div>
        {% highlight result.text with query %}
      </div>
    </li>
    {% empty %}
    <li>No results found.</li>
    {% endfor %}
  </ol>
  
  {% if page.has_previous or page.has_next %}
  <div>
    {% if page.has_previous %}<a href="?q={{ query }}&amp;page=1">1</a>
<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Prev {% if page.has_previous %}</a>{% endif %} 
    | {{ page.number }} | 
    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>
    <a href="?q={{ query }}&amp;page={{ page.paginator.num_pages }}">{{ page.paginator.num_pages }}</a>{% endif %}
    {% endif %}
</div>
</div>
</form>
{% endblock %}
